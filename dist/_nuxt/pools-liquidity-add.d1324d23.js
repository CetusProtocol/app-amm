import{_ as Yo}from"./back.5d2e1e20.js";import{_ as Mo}from"./refresh-icon.a8003b7e.js";import{_ as Vo}from"./assets-card.a340feb2.js";import{_ as Do}from"./coin-select.ea1ad3ef.js";import{_ as Xo,a as Fo}from"./img-leverage_2x.b70ec7b7.js";import{_ as jo}from"./swap-setting.3a878e8c.js";import{a as ho,Q as Wo,b as yo,r as t,i as bo,j as go,k as Eo,l as $o,J as Uo,o as r,c as R,w as j,p as e,t as n,m,q,G as zo,B as Ao,y as ko,z as wo,X as Go,e as P,Y as Jo,A as Ko,Z as Qo,$ as oo,a0 as Zo,h as Ho,a1 as xo,a2 as eo,a3 as no,a4 as oe,a5 as so,a6 as fo,a7 as po,s as Co,v as g}from"./entry.13ecce73.js";const ee=ho({components:{Modal:Wo},props:{isIncrease:{type:Boolean,required:!1},fromCoin:{type:Object,required:!0},toCoin:{type:Object,required:!0},fromCoinAmount:{type:String,required:!0},toCoinAmount:{type:String,required:!0},fixedFromCoin:{type:Boolean,required:!0},currentLpInfo:{type:Object,required:!0},share:{type:String,required:!0},rate:{type:String,required:!0},currentRecivedLp:{type:String,required:!0}},emits:["to-add","on-close"],setup(o,s){const T=yo(),v=t(T.slippage||.5),$=t(!0),y=t(!1);function a(b){$.value=b}return{importIcon:bo,fixD:go,decimalFormat:Eo,direct:$,changeDirect:a,rateChange:y,clickNextBtn:async()=>{s.emit("to-add")},slippage:v}}});const io=o=>(ko("data-v-7d9cd7a3"),o=o(),wo(),o),ne=io(()=>e("svg",{class:"icon modal-icon-close","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-Shutdown"})],-1)),se={class:"add-confirm-container"},ie={class:"card-content"},te={class:"top"},ae={class:"coin"},le=["src"],ue=["src"],re={class:"bottom"},de={class:"induction"},ce={class:"item"},me={class:"induction-text"},ve={class:"induction-value induction-value-change"},fe={key:0},pe={key:1},Ce=io(()=>e("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),he=[Ce],ye={class:"item"},be={class:"induction-text"},ge={class:"induction-value"},$e={class:"item"},Ae={class:"induction-text"},ke={key:0,class:"induction-value"},we={key:1,class:"induction-value"},Se={class:"item liquidity-item"},Le=io(()=>e("div",{class:"induction-text"},null,-1)),Ie={key:0,class:"induction-value"},qe={key:1,class:"induction-value"},Te={class:"item"},Ne={class:"induction-text"},Oe={key:0,class:"induction-value"},Be={key:1,class:"induction-value"};function _e(o,s,T,v,$,y){const a=Ao,L=Uo("Modal");return r(),R(L,{width:"440px",visible:!0,footer:null,title:o.$t("modal.addLiquidityModalTitle"),class:"add-confirm-modal",onCancel:s[1]||(s[1]=b=>o.$emit("on-close"))},{closeIcon:j(()=>[ne]),default:j(()=>[e("div",se,[e("div",ie,[e("div",te,[e("div",ae,[e("img",{src:o.fromCoin.icon||o.importIcon(`/image/coins/${o.fromCoin.symbol.toLowerCase()}.png`)},null,8,le),e("img",{src:o.toCoin.icon||o.importIcon(`/image/coins/${o.toCoin.symbol.toLowerCase()}.png`)},null,8,ue),e("p",null,n(o.currentRecivedLp)+" LP",1)])]),e("div",re,[e("div",de,[e("div",ce,[e("div",me,n(o.$t("common.rate")),1),e("div",ve,[o.rateChange?(r(),m("span",pe,"1 "+n(o.toCoin.symbol)+" \u2248 "+n(o.fixD(1/o.rate,o.fromCoin.decimals))+" "+n(o.fromCoin.symbol),1)):(r(),m("span",fe,"1 "+n(o.fromCoin.symbol)+" \u2248 "+n(o.fixD(o.rate,o.toCoin.decimals))+" "+n(o.toCoin.symbol),1)),(r(),m("svg",{class:"icon-change","aria-hidden":"true",onClick:s[0]||(s[0]=b=>o.rateChange=!o.rateChange)},he))])]),e("div",ye,[e("div",be,n(o.$t("modal.slippageTolerance")),1),e("div",ge,n(o.slippage)+"%",1)]),e("div",$e,[e("div",Ae,n(o.$t("common.liquidityDeposited")),1),o.isIncrease?(r(),m("div",we,n(o.fixD(o.currentLpInfo.myCoinXAmount,o.fromCoin.decimals))+" \u2192 "+n(o.fixD(Number(o.currentLpInfo.myCoinXAmount)+Number(o.fromCoinAmount),o.fromCoin.decimals))+" "+n(o.fromCoin.symbol),1)):(r(),m("div",ke,n(o.fromCoinAmount)+" "+n(o.fromCoin.symbol),1))]),e("div",Se,[Le,o.isIncrease?(r(),m("div",qe,n(o.fixD(o.currentLpInfo.myCoinYAmount,o.toCoin.decimals))+" \u2192 "+n(o.fixD(Number(o.currentLpInfo.myCoinYAmount)+Number(o.toCoinAmount),o.toCoin.decimals))+" "+n(o.toCoin.symbol),1)):(r(),m("div",Ie,n(o.toCoinAmount)+" "+n(o.toCoin.symbol),1))]),e("div",Te,[e("div",Ne,n(o.$t("common.shareOfPool")),1),o.isIncrease?(r(),m("div",Be,n(o.currentLpInfo.myshareOfPool)+"% \u2192 "+n(o.share)+"%",1)):(r(),m("div",Oe,n(o.share)+"%",1))])])])])]),q(a,{class:"big-btn swap-confirm-btn",onClick:o.clickNextBtn},{default:j(()=>[zo(n(o.$t("button.confirmSupply")),1)]),_:1},8,["onClick"])]),_:1},8,["title"])}const Pe=$o(ee,[["render",_e],["__scopeId","data-v-7d9cd7a3"]]),Re=ho({setup(o,s){const T=Go(),v=P(()=>T),$=yo(),y=Jo(),a=P(()=>y);let L=t(!0),b=t(!1),N=t(!1),W=t(!1),E=t(!1),U=t(!1);const O=t("fromCoin"),c=t(""),z=t(""),G=t(!1),J=t(!1),C=t(!0),to=t(!1),K=t(!1),f=t(""),p=t(""),Q=t(20),I=t(0),M=t(null),B=Ko();Qo();const V=B.currentRoute.value.query.from||Object.values(a.value.lpTokens)[0].coinA,D=B.currentRoute.value.query.to||Object.values(a.value.lpTokens)[0].coinB,l=t(""),u=t("");oo(()=>{!fo(a.value.lpTokens)&&!fo(y.tokens)&&!l.value&&!u.value&&(l.value=y.tokens[V]||Object.values(a.value.lpTokens)[0].coinA,u.value=y.tokens[D]||Object.values(a.value.lpTokens)[0].coinB)});const _=t(""),{t:A}=Zo(),So=P(()=>$.slippage),ao=P(()=>po(l.value.symbol,u.value.symbol,y.lpTokens)?v.value.assets&&v.value.assets[l.value.address]&&l.value&&Number(f.value)>Number(so(v.value.assets[l.value.address].balance,l.value.decimals))?A("button.insufficientBalance",{name:l.value.symbol}):v.value.assets&&v.value.assets[u.value.address]&&u.value&&Number(p.value)>Number(so(v.value.assets[u.value.address].balance,u.value.decimals))?A("button.insufficientBalance",{name:u.value.symbol}):Number(f.value)?A("button.addToPool"):A("button.enterAmount"):A("button.poolNotFound")),Lo=i=>{var d,h,k,S;O.value=i,i==="fromCoin"?(c.value=((d=u.value)==null?void 0:d.symbol)||"",z.value=((h=l.value)==null?void 0:h.symbol)||""):(c.value=((k=l.value)==null?void 0:k.symbol)||"",z.value=((S=u.value)==null?void 0:S.symbol)||""),G.value=!0},Io=i=>{f.value="",p.value="",O.value==="fromCoin"?(u.value&&i.symbol.toLowerCase()===(u==null?void 0:u.value.symbol.toLowerCase())&&(u.value=null),l.value=i):(l.value&&i.symbol.toLowerCase()===(l==null?void 0:l.value.symbol.toLowerCase())&&(l.value=null),u.value=i),G.value=!1},qo=(i,d)=>{i==="fromCoin"?(C.value=!0,f.value=d.value):(C.value=!1,p.value=d.value)};Ho(async()=>{const i=B.currentRoute.value.query.from,d=B.currentRoute.value.query.to;_.value=await w.getPrice({coinX:a.value.tokens[i],coinY:a.value.tokens[d]}),uo()});const lo=async()=>{I.value=0,N.value=!0,setTimeout(()=>{N.value=!1},1e3),v.value.address&&y.setMyLplist(v.value.address),_.value=await w.getPrice({coinX:a.value.tokens[V],coinY:a.value.tokens[D]})},To=()=>{const i=l.value;l.value=u.value,u.value=i,b.value=!0,setTimeout(()=>{b.value=!1},300)},uo=()=>{M.value=setInterval(()=>{to.value||I.value<Q.value&&(I.value+=1,I.value===Q.value&&(I.value=0,M.value=null,window.clearInterval(M.value),x(C.value?f.value:p.value)))},1e3)},No=async()=>{J.value=!0},w=xo();eo(C,no((i,d)=>{C.value=i},800)),eo(f,no((i,d)=>{i&&C.value&&x(i),i==""&&C.value&&(p.value="")},500)),eo(p,no((i,d)=>{i&&!C.value&&x(i),i==""&&!C.value&&(f.value="")},500));const Z=t(""),H=t(""),x=async i=>{const d=t({});if(i!==""&&ao.value!==A("common.poolNotFound")){if(C.value?d.value={coinX:a.value.tokens[l.value.symbol],coinY:a.value.tokens[u.value.symbol],amount:i}:d.value={coinX:a.value.tokens[u.value.symbol],coinY:a.value.tokens[l.value.symbol],amount:i},d.value)try{const h=await w.getLiquidityAndCoinYByCoinX(d.value);if(h==-1){H.value="100",Z.value="",f.value&&p.value?_.value=String(Number(p.value)/Number(f.value)):_.value="0";return}C.value?p.value=h.coinYAmount:f.value=h.coinYAmount,Z.value=h.lpAmountView;const k=await w.getShareOfPool({coinX:a.value.tokens[V],coinY:a.value.tokens[D],currentLpVal:h.lpAmount});H.value=k}catch{}}else C.value?p.value="":f.value=""},ro=t({});oo(async()=>{v.value.address&&y.setMyLplist(v.value.address)}),oo(()=>{if(l.value&&u.value&&a.value.myLplist&&a.value.myLplist.length>0&&v.value.address){const i=a.value.myLplist;let d;if(l.value.symbol&&u.value.symbol&&(d=po(l.value.symbol,u.value.symbol,a.value.lpTokens)),d){const h=i.filter(k=>k.symbol===d.symbol)[0];ro.value=h}}});const{setIsShowSuccess:Oo,setIsShowRejected:co,setIsShowWaiting:X,setTransactionDesc:Bo,setTransactionTxid:mo}=$,_o=async()=>{var i,d,h,k;J.value=!1,mo(""),Bo(A("tips.addLiquiditySuccessText",{from:`${f.value} ${(i=l.value)==null?void 0:i.symbol}`,to:`${p.value} ${(d=u.value)==null?void 0:d.symbol}`})),X(!0);try{const S=t({});C.value?S.value={coinX:a.value.tokens[l.value.symbol],coinY:a.value.tokens[u.value.symbol],coinXAmount:f.value,coinYAmount:p.value,slippage:Number($.slippage)/100}:S.value={coinX:a.value.tokens[u.value.symbol],coinY:a.value.tokens[l.value.symbol],coinXAmount:p.value,coinYAmount:f.value,slippage:Number($.slippage)/100};const Ro=await w.createAddLiquidityTransactionPayload(S.value),F=await v.value.currentWallet.signAndSubmitTransaction(Ro);if(F&&F.hash){mo(F.hash),X(!1),Oo(!0);const vo={title:A("common.addLiquidity"),desc:A("tips.increaseLiquiditySuccess",{from:`${f.value} ${(h=l.value)==null?void 0:h.symbol}`,to:`${p.value} ${(k=u.value)==null?void 0:k.symbol}`}),hash:F.hash};w.showTransitionPending(vo),await w.watchTransaction(vo)&&setTimeout(()=>{lo()},1e3)}else X(!1),co(!0);K.value=!1,p.value="",f.value=""}catch{K.value=!1,X(!1),co(!0),p.value="",f.value=""}},Po=P(()=>v.value.assets);return{addCommom:oe,share:H,prettyAmount:so,fixD:go,currentLpInfo:ro,lpAmountView:Z,coinfrom:V,cointo:D,router:B,wallet:v,hasLiquidity:L,importIcon:bo,clickExchange:To,clickRefresh:lo,refresh:N,change:b,isShowAddress:W,isShowSwapSetting:E,fromCoin:l,toCoin:u,slippage:So,openCoinSelect:Lo,onCoinSelect:Io,existingCoins:c,lastSelectCoin:z,currentCoinKey:O,showCoinSelect:G,fromCoinAmount:f,toCoinAmount:p,maxBtnSelect:qo,fixedFromCoin:C,BtnText:ao,clickBtn:No,loading:to,swaping:K,autoRefreshTime:Q,countdown:I,setMarketTimer:uo,marketTimer:M,rateChange:U,isShowAddConfirm:J,rate:_,toAdd:_o,assets:Po}}});const Y=o=>(ko("data-v-b1252111"),o=o(),wo(),o),Ye={class:"linquidity-add-container"},Me={class:"title"},Ve={class:"left"},De={class:"right title-right"},Xe=Y(()=>e("svg",{class:"icon","aria-hidden":"true"},[e("use",{"xlink:href":"#icon-a-icon-setslippage"})],-1)),Fe=Y(()=>e("use",{"xlink:href":"#icon-icon-information"},null,-1)),je=[Fe],We={class:"swap-card"},Ee={class:"card-container"},Ue={class:"card-item"},ze={class:"card-item"},Ge={class:"exchange"},Je=Y(()=>e("use",{"xlink:href":"#icon-icon-add1"},null,-1)),Ke=[Je],Qe={key:0,class:"induction"},Ze={key:0,class:"item"},He={class:"induction-text"},xe={class:"induction-value induction-value-change"},on={key:0},en={key:1},nn=Y(()=>e("use",{"xlink:href":"#icon-a-icon-change2"},null,-1)),sn=[nn],tn={key:1,class:"item"},an={class:"induction-text"},ln={class:"induction-value"},un={key:2,class:"item"},rn={class:"induction-text"},dn={class:"induction-value"},cn={key:0,class:"icon","aria-hidden":"true"},mn=Y(()=>e("use",{"xlink:href":"#icon-icon-add"},null,-1)),vn=[mn],fn={key:0,class:"showMyLiquidity"},pn={class:"myLiquidity"},Cn={class:"left"},hn={class:"right"},yn={class:"liquidityAsset"},bn={class:"item"},gn={class:"left"},$n=["src"],An={class:"right"},kn={class:"item"},wn={class:"left"},Sn=["src"],Ln={class:"right"},In={class:"induction induction-liquidity"},qn={class:"item"},Tn={class:"induction-text"},Nn={class:"induction-value"};function On(o,s,T,v,$,y){const a=Yo,L=Mo,b=Vo,N=Ao,W=Do,E=Fo,U=jo,O=Pe;return r(),m("div",Ye,[q(a),e("div",Me,[e("div",Ve,n(o.$t("common.addLiquidity")),1),e("div",De,[e("div",{class:"slippage-icon",onClick:s[0]||(s[0]=c=>o.isShowSwapSetting=!0)},[Xe,e("span",null,n(o.slippage)+"%",1)]),(r(),m("svg",{class:"icon information-icon","aria-hidden":"true",onClick:s[1]||(s[1]=c=>o.isShowAddress=!0)},je)),q(L,{loading:o.refresh,"auto-refresh-time":o.autoRefreshTime,countdown:o.countdown,onClickRefresh:o.clickRefresh},null,8,["loading","auto-refresh-time","countdown","onClickRefresh"])])]),e("div",We,[e("div",Ee,[e("div",Ue,[q(b,{modelValue:o.fromCoinAmount,"onUpdate:modelValue":s[2]||(s[2]=c=>o.fromCoinAmount=c),"input-value":o.fromCoinAmount,"coin-name":o.fromCoin?o.fromCoin.symbol:"","coin-address":o.fromCoin?o.fromCoin.address:"","coin-decimals":o.fromCoin?o.fromCoin.decimals:6,"coin-icon":o.fromCoin?o.fromCoin.icon:"","swap-direction":"From",onOnMax:o.maxBtnSelect,onOnInput:s[3]||(s[3]=c=>o.fromCoinAmount=c),onOnFocus:s[4]||(s[4]=()=>{o.fixedFromCoin=!0}),onOnSelect:s[5]||(s[5]=c=>o.openCoinSelect("fromCoin"))},null,8,["modelValue","input-value","coin-name","coin-address","coin-decimals","coin-icon","onOnMax"])]),e("div",ze,[q(b,{modelValue:o.toCoinAmount,"onUpdate:modelValue":s[6]||(s[6]=c=>o.toCoinAmount=c),"input-value":o.toCoinAmount,"coin-name":o.toCoin?o.toCoin.symbol:"","coin-address":o.toCoin?o.toCoin.address:"","coin-decimals":o.toCoin?o.toCoin.decimals:6,"swap-direction":"To","coin-icon":o.toCoin?o.toCoin.icon:"",onOnMax:o.maxBtnSelect,onOnInput:s[7]||(s[7]=c=>o.toCoinAmount=c),onOnFocus:s[8]||(s[8]=()=>{o.fixedFromCoin=!1}),onOnSelect:s[9]||(s[9]=c=>o.openCoinSelect("toCoin"))},null,8,["modelValue","input-value","coin-name","coin-address","coin-decimals","coin-icon","onOnMax"])]),e("img",{class:Co(o.change?"gang animationex":"gang"),src:Xo,alt:""},null,2),e("div",Ge,[(r(),m("svg",{class:Co(o.change?"icon animationex":"icon"),"aria-hidden":"true"},Ke,2))])]),o.BtnText!=="Pool not found"?(r(),m("div",Qe,[o.fromCoin&&o.toCoin?(r(),m("div",Ze,[e("div",He,n(o.$t("common.rate")),1),e("div",xe,[o.rateChange?(r(),m("span",en,"1 "+n(o.toCoin.symbol)+" \u2248 "+n(o.fixD(1/o.rate,o.fromCoin.decimals))+" "+n(o.fromCoin.symbol),1)):(r(),m("span",on,"1 "+n(o.fromCoin.symbol)+" \u2248 "+n(o.fixD(o.rate,o.toCoin.decimals))+" "+n(o.toCoin.symbol),1)),(r(),m("svg",{class:"icon-change","aria-hidden":"true",onClick:s[10]||(s[10]=c=>o.rateChange=!o.rateChange)},sn))])])):g("",!0),o.fromCoinAmount&&o.toCoinAmount?(r(),m("div",tn,[e("div",an,n(o.$t("common.shareOfPool")),1),e("div",ln,n(o.share)+"%",1)])):g("",!0),o.fromCoinAmount&&o.toCoinAmount?(r(),m("div",un,[e("div",rn,n(o.$t("common.lPTokensReceived")),1),e("div",dn,n(o.lpAmountView),1)])):g("",!0)])):g("",!0)]),q(N,{disabled:o.wallet.connected?o.loading||o.swaping||!o.fromCoin||!o.toCoin||!Number(o.fromCoinAmount)||!Number(o.toCoinAmount)||o.swapBtnText==o.$t("button.poolNotFound")||Number(o.fromCoinAmount)>o.prettyAmount(o.assets[o.fromCoin.address].balance,o.fromCoin.decimals)||Number(o.toCoinAmount)>o.prettyAmount(o.assets[o.toCoin.address].balance,o.toCoin.decimals):!1,loading:o.swaping,class:"big-btn",onClick:s[11]||(s[11]=c=>o.wallet.connected?o.isShowAddConfirm=!0:o.wallet.setIsShowWalletModal(!0))},{default:j(()=>[o.wallet.connected?(r(),m("svg",cn,vn)):g("",!0),e("span",null,n(o.wallet.connected?o.BtnText:o.$t("button.connectWallet")),1)]),_:1},8,["disabled","loading"]),o.currentLpInfo&&o.currentLpInfo.myLpBalance&&Number(o.currentLpInfo.balance)!==0&&o.wallet.connected&&o.BtnText!==o.$t("button.poolNotFound")?(r(),m("div",fn,[e("div",pn,[e("div",Cn,n(o.$t("common.yourLiquidity")),1),e("div",hn,[e("p",null,n(o.currentLpInfo.myLpBalance)+" LP",1),e("span",null,"\u2248 $"+n(o.addCommom(o.currentLpInfo.myBalanceUSD,2)),1)])]),e("div",yn,[e("div",bn,[e("div",gn,[e("img",{src:o.fromCoin.icon||o.importIcon(`/image/coins/${o.fromCoin.symbol.toLowerCase()}.png`),alt:""},null,8,$n),e("span",null,n(o.fromCoin.symbol),1)]),e("div",An,n(o.currentLpInfo.myCoinXAmount),1)]),e("div",kn,[e("div",wn,[e("img",{src:o.toCoin.icon||o.importIcon(`/image/coins/${o.toCoin.symbol.toLowerCase()}.png`),alt:""},null,8,Sn),e("span",null,n(o.toCoin.symbol),1)]),e("div",Ln,n(o.currentLpInfo.myCoinYAmount),1)])]),e("div",In,[e("div",qn,[e("div",Tn,n(o.$t("common.shareOfPool")),1),e("div",Nn,n(o.currentLpInfo.myshareOfPool)+" %",1)])])])):g("",!0),o.showCoinSelect?(r(),R(W,{key:1,"existing-coins":o.existingCoins,"last-select-coin":o.lastSelectCoin,onOnSelect:o.onCoinSelect,onOnClose:s[12]||(s[12]=c=>o.showCoinSelect=!1)},null,8,["existing-coins","last-select-coin","onOnSelect"])):g("",!0),o.isShowAddress?(r(),R(E,{key:2,"from-coins":o.fromCoin,"to-coins":o.toCoin,onOnClose:s[13]||(s[13]=c=>o.isShowAddress=!1)},null,8,["from-coins","to-coins"])):g("",!0),o.isShowSwapSetting?(r(),R(U,{key:3,onOnClose:s[14]||(s[14]=c=>o.isShowSwapSetting=!1)})):g("",!0),o.isShowAddConfirm?(r(),R(O,{key:4,"current-lp-info":o.currentLpInfo,"is-increase":!!(o.currentLpInfo&&o.currentLpInfo.balance),"fixed-from-coin":o.fixedFromCoin,"from-coin":o.fromCoin,"to-coin":o.toCoin,share:o.share,rate:o.rate,"lp-amount":o.lpAmountView,"from-coin-amount":o.fromCoinAmount,"to-coin-amount":o.toCoinAmount,"current-recived-lp":o.lpAmountView,onOnClose:s[15]||(s[15]=c=>o.isShowAddConfirm=!1),onToAdd:o.toAdd},null,8,["current-lp-info","is-increase","fixed-from-coin","from-coin","to-coin","share","rate","lp-amount","from-coin-amount","to-coin-amount","current-recived-lp","onToAdd"])):g("",!0)])}const Xn=$o(Re,[["render",On],["__scopeId","data-v-b1252111"]]);export{Xn as default};
